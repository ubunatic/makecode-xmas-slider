namespace SpriteKind {
    export const Ground = SpriteKind.create()
    export const Tree = SpriteKind.create()
    export const Present = SpriteKind.create()
}
function checkScore () {
    if (score >= 100) {
        game.over(true)
    }
}
function updateJump (sprite: Sprite, jumping: boolean) {
    if (_jump > 0 && jumping) {
        _jump += 1
        sprite.vy = sprite.vy * 0.97
    } else if (_jump > 0) {
        _jump = 0
        sprite.vy = sprite.vy * 0.5
    } else {
        _jump = 0
    }
    if (_jump > 30) {
        _jump = 0
    }
    if (_jump == 0) {
        sprite.ay = gravity
    }
}
function addGroundAt (x: number, y: number) {
    _ground = sprites.create(grounds[randint(0, 4)], SpriteKind.Ground)
    _ground.left = x
    _ground.top = y
    _ground.image.fillRect(0, 60, 160, 120, 1)
    return _ground
}
function updatePlayer (sprite: Sprite) {
    if (sprite.x > 40) {
        sprite.vx = 0
    }
    updateJump(sprite, controller.A.isPressed())
    if (isOnGround(sprite)) {
        slideOnGround(sprite)
        _ground_time = ground_lag
        if (controller.A.isPressed()) {
            jump(santa)
            _ground_time = 0
        }
    } else {
        _ground_time = Math.max(0, _ground_time - 1)
    }
    if (_y_prev - sprite.y > 1) {
        _slope_time = _slope_time * 0.5
    } else {
        _slope_time += 1
    }
    _y_prev = sprite.y
    debug()
}
function updateSpeedMeter () {
    speed_meter.setText("" + Math.round(speed * 10 + Math.max(0, 0.1 * santa.vy)) + " km/h")
}
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    if (isOnGround(santa) || _ground_time > 0) {
        jump(santa)
    }
})
function limitSpeed () {
    speed = Math.constrain(speed, 0, 5)
}
controller.right.onEvent(ControllerButtonEvent.Repeated, function () {
    speed += 0.1
})
controller.left.onEvent(ControllerButtonEvent.Pressed, function () {
    speed += -0.2
})
function generateGrounds () {
    return [img`
        ................................................................................................................................................................
        1111............................................................................................................................................................
        111111..........................................................................................................................................................
        1111111.........................................................................................................................................................
        111111111.......................................................................................................................................................
        11111111111.....................................................................................................................................................
        111111111111....................................................................................................................................................
        1111111111111...................................................................................................................................................
        111111111111111111..............................................................................................................................................
        111111111111111111111...........................................................................................................................................
        11111111111111111111111111111...................................................................................................................................
        111111111111111111111111111111111111............................................................................................................................
        1111111111111111111111111111111111111111........................................................................................................................
        1111111111111111111111111111111111111111111.....................................................................................................................
        1111111111111111111111111111111111111111111111..................................................................................................................
        1111111111111111111111111111111111111111111111111...............................................................................................................
        1111111111111111111111111111111111111111111111111111............................................................................................................
        1111111111111111111111111111111111111111111111111111111.........................................................................................................
        1111111111111111111111111111111111111111111111111111111111......................................................................................................
        111111111111111111111111111111111111111111111111111111111111....................................................................................................
        111111111111111111111111111111111111111111111111111111111111111.................................................................................................
        1111111111111111111111111111111111111111111111111111111111111111................................................................................................
        111111111111111111111111111111111111111111111111111111111111111111..............................................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111..........................................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111........................................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111.....................................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111..................................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111................................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111..............................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111............................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111......................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111....................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...............................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.............................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...........................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.............................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111....................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...............
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..............
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..........
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        `, img`
        ................................................................................................................................................................
        1111............................................................................................................................................................
        111111..........................................................................................................................................................
        1111111111111...................................................................................................................................................
        1111111111111111................................................................................................................................................
        111111111111111111111...........................................................................................................................................
        11111111111111111111111.........................................................................................................................................
        1111111111111111111111111.......................................................................................................................................
        11111111111111111111111111......................................................................................................................................
        1111111111111111111111111111....................................................................................................................................
        11111111111111111111111111111...................................................................................................................................
        11111111111111111111111111111111................................................................................................................................
        1111111111111111111111111111111111..............................................................................................................................
        11111111111111111111111111111111111.............................................................................................................................
        111111111111111111111111111111111111111111111...................................................................................................................
        111111111111111111111111111111111111111111111111................................................................................................................
        111111111111111111111111111111111111111111111111111.............................................................................................................
        1111111111111111111111111111111111111111111111111111............................................................................................................
        111111111111111111111111111111111111111111111111111111..........................................................................................................
        11111111111111111111111111111111111111111111111111111111........................................................................................................
        111111111111111111111111111111111111111111111111111111111.......................................................................................................
        1111111111111111111111111111111111111111111111111111111111......................................................................................................
        11111111111111111111111111111111111111111111111111111111111.....................................................................................................
        111111111111111111111111111111111111111111111111111111111111....................................................................................................
        11111111111111111111111111111111111111111111111111111111111111..................................................................................................
        1111111111111111111111111111111111111111111111111111111111111111................................................................................................
        111111111111111111111111111111111111111111111111111111111111111111..............................................................................................
        111111111111111111111111111111111111111111111111111111111111111111111...........................................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111.......................................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111....................................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111..................................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111.................................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111...............................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111.............................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111............................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111...........................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111......................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111....................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..............................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.............................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111....................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...............
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.............
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...........
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..........
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111......
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        `, img`
        ................................................................................................................................................................
        1111............................................................................................................................................................
        111111..........................................................................................................................................................
        1111111.........................................................................................................................................................
        111111111.......................................................................................................................................................
        11111111111.....................................................................................................................................................
        111111111111....................................................................................................................................................
        1111111111111...................................................................................................................................................
        1111111111111111111.............................................................................................................................................
        111111111111111111111...........................................................................................................................................
        11111111111111111111111.........................................................................................................................................
        111111111111111111111111........................................................................................................................................
        1111111111111111111111111.......................................................................................................................................
        111111111111111111111111111.....................................................................................................................................
        1111111111111111111111111111....................................................................................................................................
        11111111111111111111111111111...................................................................................................................................
        111111111111111111111111111111..................................................................................................................................
        1111111111111111111111111111111.................................................................................................................................
        1111111111111111111111111111111.................................................................................................................................
        11111111111111111111111111111111................................................................................................................................
        11111111111111111111111111111111................................................................................................................................
        11111111111111111111111111111111................................................................................................................................
        111111111111111111111111111111111...............................................................................................................................
        1111111111111111111111111111111111..............................................................................................................................
        11111111111111111111111111111111111.............................................................................................................................
        111111111111111111111111111111111111............................................................................................................................
        111111111111111111111111111111111111............................................................................................................................
        1111111111111111111111111111111111111...........................................................................................................................
        1111111111111111111111111111111111111...........................................................................................................................
        11111111111111111111111111111111111111..........................................................................................................................
        111111111111111111111111111111111111111.........................................................................................................................
        111111111111111111111111111111111111111.........................................................................................................................
        111111111111111111111111111111111111111.........................................................................................................................
        1111111111111111111111111111111111111111........................................................................................................................
        11111111111111111111111111111111111111111.......................................................................................................................
        111111111111111111111111111111111111111111......................................................................................................................
        111111111111111111111111111111111111111111......................................................................................................................
        1111111111111111111111111111111111111111111.....................................................................................................................
        111111111111111111111111111111111111111111111...................................................................................................................
        11111111111111111111111111111111111111111111111.................................................................................................................
        1111111111111111111111111111111111111111111111111111............................................................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111......................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111....................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...............................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111....
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        `, img`
        ................................................................................................................................................................
        1111............................................................................................................................................................
        111111..........................................................................................................................................................
        1111111.........................................................................................................................................................
        111111111...............1111111111111...........................................................................................................................
        1111111111111....11111111111111111111111........................................................................................................................
        11111111111111111111111111111111111111111.......................................................................................................................
        1111111111111111111111111111111111111111111.....................................................................................................................
        1111111111111111111111111111111111111111111.....................................................................................................................
        1111111111111111111111111111111111111111111.....................................................................................................................
        1111111111111111111111111111111111111111111.....................................................................................................................
        1111111111111111111111111111111111111111111.....................................................................................................................
        11111111111111111111111111111111111111111111....................................................................................................................
        11111111111111111111111111111111111111111111....................................................................................................................
        11111111111111111111111111111111111111111111....................................................................................................................
        11111111111111111111111111111111111111111111....................................................................................................................
        111111111111111111111111111111111111111111111...................................................................................................................
        111111111111111111111111111111111111111111111...................................................................................................................
        111111111111111111111111111111111111111111111...................................................................................................................
        111111111111111111111111111111111111111111111...................................................................................................................
        111111111111111111111111111111111111111111111...................................................................................................................
        1111111111111111111111111111111111111111111111..................................................................................................................
        1111111111111111111111111111111111111111111111..................................................................................................................
        11111111111111111111111111111111111111111111111.................................................................................................................
        11111111111111111111111111111111111111111111111.................................................................................................................
        111111111111111111111111111111111111111111111111................................................................................................................
        1111111111111111111111111111111111111111111111111...............................................................................................................
        11111111111111111111111111111111111111111111111111..............................................................................................................
        11111111111111111111111111111111111111111111111111..............................................................................................................
        1111111111111111111111111111111111111111111111111111............................................................................................................
        11111111111111111111111111111111111111111111111111111...........1111111111111111111111..........................................................................
        1111111111111111111111111111111111111111111111111111111...111111111111111111111111111111........................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111......................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...................1111111111.......................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.................11111111111.......................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............1111111111111111.....................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........11111111111111111111...................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...............................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..............................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.............................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...........................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...........................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..........................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...............
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.............
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111....
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        `, img`
        ................................................................................................................................................................
        1111............................................................................................................................................................
        111111..........................................................................................................................................................
        1111111.........................................................................................................................................................
        111111111.......................................................................................................................................................
        1111111111......................................................................................................................................................
        11111111111.....................................................................................................................................................
        1111111111111...................................................................................................................................................
        11111111111111..................................................................................................................................................
        11111111111111111...............................................................................................................................................
        1111111111111111111.............................................................................................................................................
        111111111111111111111...........................................................................................................................................
        11111111111111111111111.........................................................................................................................................
        11111111111111111111111111......................................................................................................................................
        111111111111111111111111111.....................................................................................................................................
        11111111111111111111111111111...................................................................................................................................
        11111111111111111111111111111111................................................................................................................................
        111111111111111111111111111111111111............................................................................................................................
        1111111111111111111111111111111111111111........................................................................................................................
        1111111111111111111111111111111111111111111.....................................................................................................................
        111111111111111111111111111111111111111111111111................................................................................................................
        111111111111111111111111111111111111111111111111111.............................................................................................................
        1111111111111111111111111111111111111111111111111111111.........................................................................................................
        111111111111111111111111111111111111111111111111111111111111....................................................................................................
        1111111111111111111111111111111111111111111111111111111111111111................................................................................................
        111111111111111111111111111111111111111111111111111111111111111111111...........................................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111......................................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111..................................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111...............................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111...........................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........................................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...................................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111................................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..............................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..........................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......................................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.................................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111................................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..............................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111............................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..........................................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111........................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111......................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111....................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.................................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111................................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..............................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...........................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.........................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.......................
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.....................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...................
        111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111................
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111...........
        11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111..
        1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        `]
}
function changeScoreBy (num: number) {
    score += num
    score = Math.max(0, score)
    score_meter.setText("" + score)
    score_meter.top = 2
    score_meter.left = 2
    score_meter.setIcon(img`
        . . . . . . . 
        . . . . . . . 
        . . 5 . 5 . . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . . . . . . . 
        . . . . . . . 
        . . . . . . . 
        `)
}
function bounce (sprite: Sprite, ratio: number) {
    sprite.vy = sprite.vy * ratio
}
function isOnGround (sprite: Sprite) {
    return sprite.overlapsWith(ground) || sprite.overlapsWith(ground_next)
}
controller.right.onEvent(ControllerButtonEvent.Pressed, function () {
    speed += 0.1
})
function debug () {
    if (_debug) {
        _fps = 1000 / (game.runtime() - _frame_time)
        _frame_time = game.runtime()
        _debug_text.setText("g=" + _ground_time + " v=" + Math.round(santa.vy) + " o=" + obstacles.length + " s=" + Math.round(_slope_time) + "fps=" + Math.round(_fps))
        if (_ground_time == 0) {
            scene.setBackgroundColor(6)
        } else {
            scene.setBackgroundColor(9)
        }
    }
}
function slideOnGround (sprite: Sprite) {
    if (_ground_time == 0 && sprite.vy > 10) {
        sprite.startEffect(effects.blizzard, 500)
    }
    putOnGround(sprite)
    sprite.vy = ground_pressure
}
sprites.onOverlap(SpriteKind.Player, SpriteKind.Present, function (sprite, otherSprite) {
    changeScoreBy(1)
    otherSprite.destroy()
    music.playTone(415, music.beat(BeatFraction.Eighth))
    music.playTone(554, music.beat(BeatFraction.Quarter))
})
function moveGround () {
    move(ground)
    move(ground_next)
    if (ground.left <= 0 - scene.screenWidth()) {
        ground.destroy()
        ground = ground_next
        ground_next = addGroundAt(ground.right, 90)
        addObstacles()
    }
    for (let value of obstacles) {
        move(value)
    }
}
function jump (sprite: Sprite) {
    if (_jump == 0) {
        putOnGround(sprite)
        sprite.ay = 0
        sprite.vy = -100 - _slope_time * 0
        sprite.startEffect(effects.blizzard, 500)
        _jump = 2
        _ground_time = 0
        music.jumpUp.play()
    }
}
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Ground, function (sprite, otherSprite) {
    sprite.destroy(effects.disintegrate, 100)
})
function putOnGround (sprite: Sprite) {
    while (isOnGround(sprite)) {
        sprite.y += -1
    }
}
function crashSound () {
    music.playTone(131, music.beat(BeatFraction.Sixteenth))
    music.rest(music.beat(BeatFraction.Sixteenth))
    music.playTone(165, music.beat(BeatFraction.Sixteenth))
    music.rest(music.beat(BeatFraction.Sixteenth))
    music.playTone(131, music.beat(BeatFraction.Sixteenth))
}
function move (sprite: Sprite) {
    sprite.left += -1 * speed
    sprite.top += -0.375 * speed
}
function addObstacleOn (sprite: Sprite, ground: Sprite) {
    sprite.setPosition(randint(ground.left, ground.left + scene.screenWidth()), ground.bottom)
    putOnGround(sprite)
    sprite.y += 2
    obstacles.push(sprite)
}
sprites.onOverlap(SpriteKind.Player, SpriteKind.Tree, function (sprite, otherSprite) {
    otherSprite.destroy(effects.disintegrate, 500)
    crashSound()
    changeScoreBy(-3)
    projectile = sprites.createProjectileFromSprite(img`
        . . . . . . . 
        . . . . . . . 
        . . 5 . 5 . . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . . . . . . . 
        . . . . . . . 
        . . . . . . . 
        `, sprite, -50, 0)
    projectile.setFlag(SpriteFlag.AutoDestroy, true)
    projectile = sprites.createProjectileFromSprite(img`
        . . . . . . . 
        . . . . . . . 
        . . 5 . 5 . . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . . . . . . . 
        . . . . . . . 
        . . . . . . . 
        `, sprite, -40, 10)
    projectile.setFlag(SpriteFlag.AutoDestroy, true)
    projectile = sprites.createProjectileFromSprite(img`
        . . . . . . . 
        . . . . . . . 
        . . 5 . 5 . . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . 4 4 5 4 4 . 
        . . . . . . . 
        . . . . . . . 
        . . . . . . . 
        `, sprite, -45, -10)
    projectile.setFlag(SpriteFlag.AutoDestroy, true)
})
function addObstacles () {
    addObstacleOn(sprites.create(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . 7 . . . . . . . . 
        . . . . . . 7 6 7 . . . . . . . 
        . . . . . . 6 7 6 . . . . . . . 
        . . . . . 7 7 6 7 7 . . . . . . 
        . . . . . 7 6 7 6 6 . . . . . . 
        . . . . . 7 6 7 7 7 7 . . . . . 
        . . . . 7 6 7 7 6 6 7 . . . . . 
        . . . . 6 7 7 6 7 7 6 . . . . . 
        . . . . 7 6 6 7 6 7 7 7 . . . . 
        . . . 6 6 7 7 6 6 6 6 7 7 . . . 
        . . . . . . . 6 . . . . . . . . 
        . . . . . . . e . . . . . . . . 
        . . . . . . . e . . . . . . . . 
        . . . . . . . d . . . . . . . . 
        . . . . . . . 1 . . . . . . . . 
        `, SpriteKind.Tree), ground_next)
    addObstacleOn(sprites.create(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . 5 . . . 5 . . . . . 
        . . . . . 5 . 5 . 5 . 4 . . . . 
        . . . . . . 5 4 5 5 4 . . . . . 
        . . . . . 2 2 2 4 2 2 c . . . . 
        . . . . . 2 2 2 4 2 2 c . . . . 
        . . . . . 2 2 2 4 2 2 c . . . . 
        . . . . . 2 2 2 4 2 2 c . . . . 
        . . . . . c c c 4 c c c . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, SpriteKind.Present), ground_next)
    addObstacleOn(sprites.create(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . 5 . . . 5 . . . . . 
        . . . . . 5 . 5 . 5 . 4 . . . . 
        . . . . . . 5 4 5 5 4 . . . . . 
        . . . . . 2 2 2 4 2 2 c . . . . 
        . . . . . 2 2 2 4 2 2 c . . . . 
        . . . . . 2 2 2 4 2 2 c . . . . 
        . . . . . 2 2 2 4 2 2 c . . . . 
        . . . . . c c c 4 c c c . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, SpriteKind.Present), ground_next)
    while (obstacles.length > 20) {
        obstacles.shift().destroy()
    }
}
controller.left.onEvent(ControllerButtonEvent.Repeated, function () {
    speed += -0.2
})
let projectile: Sprite = null
let _fps = 0
let _ground: Sprite = null
let _jump = 0
let _debug = false
let _frame_time = 0
let ground_lag = 0
let ground_pressure = 0
let _y_prev = 0
let _slope_time = 0
let _ground_time = 0
let score = 0
let obstacles: Sprite[] = []
let _debug_text: TextSprite = null
let score_meter: TextSprite = null
let speed_meter: TextSprite = null
let speed = 0
let ground_next: Sprite = null
let ground: Sprite = null
let santa: Sprite = null
let grounds: Image[] = []
let gravity = 0
music.setVolume(80)
gravity = 200
grounds = generateGrounds()
santa = sprites.create(img`
    . . . . 2 2 . . . . . . . . . . 
    . . . 2 2 2 2 . . . . . . . . . 
    . . 2 2 1 d d . . . . . . . . . 
    . 1 . . 1 1 d 1 . . . . . . . . 
    . . . c c 1 1 1 . . . . . . . . 
    . . b e b c 2 1 . . . . . . . . 
    . b e e b e 2 2 d b . . . . . . 
    . e e e c b e e e . b b . . . . 
    . . e c b 2 2 2 2 2 . . b b f . 
    . . . 4 e 4 e 4 c c 4 e 4 . f . 
    . . . . . f . . c c c . . f f . 
    . . . f f f f f f f f f f f . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    `, SpriteKind.Player)
santa.setPosition(0, 0)
santa.vx = 50
santa.vy = 50
santa.ay = gravity
scene.setBackgroundColor(9)
ground = addGroundAt(0, 30)
ground_next = addGroundAt(scene.screenWidth(), 90)
speed = 2
speed_meter = textsprite.create("")
score_meter = textsprite.create("", 0, 6)
_debug_text = textsprite.create("", 1, 2)
speed_meter.left = 60
speed_meter.top = 2
_debug_text.bottom = scene.screenHeight()
_debug_text.left = 2
_debug_text.z = 1
obstacles = []
score = 0
_ground_time = 0
_slope_time = 0
_y_prev = 0
ground_pressure = 0
ground_lag = 10
_frame_time = game.runtime()
_debug = false
changeScoreBy(0)
game.onUpdate(function () {
    limitSpeed()
    moveGround()
    updatePlayer(santa)
    updateSpeedMeter()
    checkScore()
})
